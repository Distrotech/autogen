#! /bin/sh
#  -*- Mode: Shell-script -*-
# ----------------------------------------------------------------------
# expr.test --- [= % name (sprintf "%%-18s" "%s") =] expression
#
# Author:	     Bruce Korb <autogen@linuxbox.com>
# Maintainer:	     Bruce Korb <autogen@linuxbox.com>
# Created:	     Sat Mar 28 14:21:31 1998
# Last Modified:  $Date: 2000/03/19 19:55:15 $
#            by:     Bruce Korb <autogen@linuxbox.com>
#
# $Id: expr.test,v 1.11 2000/03/19 19:55:15 bruce Exp $
# ----------------------------------------------------------------------

# Common definitions
if test -z "$srcdir"; then
    srcdir=`echo "$0" | sed 's,[^/]*$,,'`
    test -z "$srcdir" && srcdir=.
    test "$srcdir" = "$0" && srcdir=.
    test "${VERBOSE+set}" != set && VERBOSE=1
fi
. $srcdir/defs
workdir=`pwd`
cp ${top_srcdir}/agen5/snarf.tpl ${top_srcdir}/agen5/exp*.c \
   ${top_srcdir}/agen5/func*.c $workdir

cat > ./${testname}.sh <<- _EOF_
GD="${top_builddir}/getdefs/getdefs"
AG="${top_builddir}/agen5/AutoGen"

_EOF_
sed -n '/  expr.ini /,/date > stamp-exprini/p' \
  ${top_srcdir}/agen5/bootstrap.dir | \
    sed -e 1d -e '$d' >> ./${testname}.sh

sh -x ./${testname}.sh
sed '1,6d' ./expr.ini > expr.out
sed '1,6d' ${top_srcdir}/agen5/expr.ini > expr.base

diff expr.base expr.out || \
  failure expr.ini differs from ${top_srcdir}/agen5/expr.ini

cleanup
# expr.test ends here
